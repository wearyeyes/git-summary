# Основы работы с системой контроля версий, на примере git

**Система контроля версий (Version Control System, VCS)** - программное обеспечение, позволяющее изменять содержимое файлов, записывать информацию об этих изменениях (автор, дата изменения) для дальнейшего ее просмотра, создавать несколько версий этих файлов и безопасно возвращаться к более ранним версиям. 

**Модели управления версиями:**

- **Lock-Modify-Unlock.** Предположим у нас есть два пользователя: А и Б. Пользователь А копирует нужный файл к себе на компьютер для дальнейшей работы и блокирует работу с ним для пользователя Б. После необходимой модификации он отправляет измененный файл на центральный сервер и снимает с него блокировку, после чего другой пользователь (Б) может начать с ним работать по той же схеме. 

- **Copy-Modify-Merge.** Пользователи создают рабочии копии единого проекта на своих локальных машиных. Работают с ними параллельно, модифицируют, а затем отправляют файлы обратно в центральный репозиторий (этот процесс носит название слияния, merging). В таком случае может возникнуть конфликт, когда несколько пользователей работали над одним файлом, и кому-то из них придется решить какую версию оставлять. 

**Виды систем контроля версий:**
- **Локальные системы контроля версий.** 
Репозиторий хранится на локальном компьютере.
- **Централизованные системы контроля версий (ЦСКВ).** 
Самые известные: CVS, Subversion и Perforce. Используется единственный сервер, содержащий все версии файлов. Клиенты копируют отдельный файлы к себе на компьютер для работы, а затем отправляют на сервер. 
- **Распределённые системы контроля версий (РСКВ, или Distributed Version Control System, DVCS).**
Git, Mercurial, Bazaar или Darcs. Клиенты полностью копируют весь репозиторий из центрального хранилища со всей историей изменений и работают с ней локально, периодически отправляя готовые версии на единый сервер. 

## Архитектура Git

Большинство систем контроля версий хранят информацию в виде списка изменений в файлах. Такая модель называется контролем версий, основанным на различиях. 
Git хранит данные в виде потока снимков, т.е. версий репозитория с информацией о всех изменениях. При этом файлы могут находиться в трех состояниях: **измененном** (`modified`), **подготовленном** (`staged`) и **зафиксированном** (`committed`). 
Схема работы с репозиторием выглядит следующим образом:
Пользователь копирует репозиторий на свой компьютер (`pull`).
Модифицирует файлы работая в рабочей копии проекта (working copy).
Добавляет их в область подготовленных файлов (staging area, также часто называется `index`). При этом он может добавлять и удалять документы из этой области. 
Когда все нужные изменения сделаны и находятся в staging area, пользователь может отправить их в локальный git-репозиторий, сделать снимок. Эта операция носит название коммита (`commit`). Таким образом создается новая версия проекта. 
Так же есть возможность перепрыгнуть на определенную версию проекта с помощью команды `checkout` и отправить зафиксированные версии (коммиты) на удаленный репозиторий (`push`). 

## Работа с локальным репозиторием. Основные команды

После установки Git на ваш компьютер его необходимо настроить:

```
$ git config --global user.name "User Name"
$ git config --global user.email username@example.com
```

Чтобы создать новый репозиторий проекта воспользуйтесь командой git init: 

```
 $ git init project_name
```

Или просто `git init` находясь в папке проекта. 

Для просмотра истории коммитов:

```
$ git log
```

Или в кратком формате:

```
$ git log --oneline
```

Чтобы отобразит определенное количество последних коммитов воспользуйтесь ключем -n:
```
$ git log -n 3 --oneline
```

С определенного времени:
```
$ git log --since="2018-03-05 23:21:00" --oneline
```
До конкретной даты:
```
$ git log --until="2018-03-05 23:21:00" --oneline
```
Поиск коммитов по их автору:
```
$ git log --author="name" --oneline
```
По слову с помощью grep:
```
$ git log --grep="word" --oneline
```

Для просмотра состояния рабочей директории:
```
$ git status
```

В кратком виде:
```
$ git status -s
```
Добавление изменений в staging area:
```
$ git add filename
```
Вместо имени файла можно использовать точку (`git add .`). Тогда будут добавлены все измененные  файлы. Так же можно добавить только файлы с конкретным расширением: 
```
$ git add *.java
```
Создание коммита:
```
$ git commit -m “description of the commit”
```
Для того чтобы вернуться к определенному коммиту, т.е. версии проекта, можно воспользоваться командой checkout:
```
$ git checkout <commit-id>
```
Так происходит смещение указателя HEAD. 
А для возвращения к последней версии проекта нужно вместо идентификатора коммита написать название ветки. Чаще всего это master (главная ветка проекта):
```
$ git checkout master
```
